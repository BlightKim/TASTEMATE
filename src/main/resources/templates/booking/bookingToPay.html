<!DOCTYPE html>
<html lagn="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<th:block th:replace="header_footer/header :: headerFragment"></th:block>

<head>
  <meta charset="UTF-8">
  <title>my bookmark</title>

  <link rel="stylesheet" th:href="@{/css/store_css.css}">

<style>

  .img-wrapper {
    position: relative;
    width: 300px;
    height: 300px;
  }
  .img-wrapper img {
    position: absolute;
    top: 0;
    left: 0;
    transform: translate(50, 50);
    width: 100%;
    height: 100%;
    object-fit: cover;
    margin: auto;
  }

  .imgText {
    width: 400px;
  }

  /* Additional spacing styles */
  .mt-4 {
    margin-top: 1.5rem !important;
  }
  .mb-4 {
    margin-bottom: 1.5rem !important;
  }
  .pt-4 {
    padding-top: 1.5rem !important;
  }
  .pb-4 {
    padding-bottom: 1.5rem !important;
  }

  .padding_100 {
    padding-left: 100px;
  }
  .center {
    align-content: center;
    text-align: center;
  }
  ul{
    list-style:none;
  }


</style>

</head>
<body>
<main>
  <div class="container py-4">
    <div class="p-5 mb-4 bg-light rounded-3">
      <div class="row">
      <div class="col-md-6 center">
        <div class="imgText padding_100">
          <div class="img-wrapper">
            <img th:src="@{|/store/${storeVO.filename}|}" class="img-fluid img_size mb-4"/>
          </div>
        </div>
          <span th:text="${storeVO.category1}" class="purple2"></span>
          <h2 class="display-5 fw-bold" th:text="${storeVO.storeName}"></h2>
        <div th:text="${storeVO.storeAddress}" class="purple2"></div>
      </div>
      <div class="col-md-6">
        <div id="map" style="width:450px;height:400px;"></div><br>
      </div>
      </div>
    </div>

    <div class="row align-items-md-stretch">
      <div class="col-md-6 center" style="padding-left: 20px; padding-top: 35px;">
          <h3 style="padding-left: 40px;">예약 정보</h3>
          <br>
          <ul>
            <li>
              <strong>예약자 이름:</strong> [[${bookingVO.userName}]]
            </li>
            <li>
              <strong>예약 메뉴:</strong> [[${bookingVO.foodName}]]
            </li>
            <li>
              <strong>예약 일시:</strong> [[${bookingVO.bookingDate}]]
            </li>
            <li>
              <strong>예약 일자:</strong> [[${bookingVO.bookingTime}]]
            </li>
            <li>
              <strong>결제 금액:</strong> [[${bookingVO.price}]]
            </li>
          </ul>
      </div>
      <div class="col-md-6">
        <div class="h-100 p-5 bg-light border rounded-3">
          <h2>유의사항</h2>
          <br>
          <p>예약/결제 취소 : 예약 일자의 1시간 전까지<br>시간이 경과한 예약 건에 대해서는 관리자에게 문의</p>
          <a th:onclick="iamport()" class="btn btn-primary" style="background-color: #8E48C7; border: none; border-radius: 10%; color: white;">결제하기</a>
          <a th:href="@{/store/list}" class="btn btn-success" style="background-color: #9C91B3; border: none; border-radius: 10%;">우야노</a>
          <button class="btn btn-outline-secondary" type="button">Example button</button>
        </div>
      </div>
    </div>
  </div>
</main>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdn.iamport.kr/js/iamport.payment-1.1.5.js"></script>

<script>

  function iamport(){
    var IMP = window.IMP;
    //가맹점 식별코드
    IMP.init('imp40866160');
    IMP.request_pay({
      pg : 'html5_inicis',
      pay_method : 'card',
      merchant_uid : 'merchant_' + new Date().getTime(),
      name : '그냥하염없이눈물이나' , //결제창에서 보여질 이름
      amount : 1000, //실제 결제되는 가격
      buyer_email : 'kchj8177@naver.com',
      buyer_name : '김채정',
      buyer_tel : '010-1234-5678',
      buyer_addr : '서울 용산',
      buyer_postcode : '123-456'
    }, function(rsp) {
      console.log(rsp);
      if ( rsp.success ) {
        var msg = '결제가 완료되었습니다.';
        msg += '고유ID : ' + rsp.imp_uid;
        msg += '상점 거래ID : ' + rsp.merchant_uid;
        msg += '결제 금액 : ' + rsp.paid_amount;
        msg += '카드 승인번호 : ' + rsp.apply_num;
      } else {
        var msg = '결제에 실패하였습니다.';
        msg += '에러내용 : ' + rsp.error_msg;
      }
      alert(msg);
    });
  }
</script>

<!-- 카카오 지도 -->
<script type="text/javascript"
        src="//dapi.kakao.com/v2/maps/sdk.js?appkey=8abceac52f5d250937ec886cf8cd8d21"></script>

<script th:inline="javascript">
  //카카오 지도 사용하기
  var container = document.getElementById('map');


  var lati = /*[[${storeVO.storeLati}]]*/;
  var longi = /*[[${storeVO.storeLongi}]]*/;

  console.log(lati);
  console.log(longi);


  var options = {
    center: new kakao.maps.LatLng(lati, longi),
    /* https://map.kakao.com/?urlX=523954.0&urlY=1084098.0*/
    level: 3
  };

  var map = new kakao.maps.Map(container, options);


  //마커찍기
  // 마커가 표시될 위치입니다
  var markerPosition  = new kakao.maps.LatLng(lati, longi);

  // 마커를 생성합니다
  var marker = new kakao.maps.Marker({
    position: markerPosition
  });

  // 마커가 지도 위에 표시되도록 설정합니다
  marker.setMap(map);

  // 아래 코드는 지도 위의 마커를 제거하는 코드입니다
  // marker.setMap(null);
</script>
<!-- 카카오 지도 끝 -->

<th:block th:replace="header_footer/footer :: footerFragment"></th:block>

</body>
</html>